<% const setting = locals.setting %>
<% if (setting.license) { %>
<!-- 와플보드 (Waffle Board) -->
<!-- https://waffleboard.io -->
<% } %>
<link rel="stylesheet" href="/stylesheets/reset.css">
<link rel="stylesheet" href="/stylesheets/style.css">
<link rel="stylesheet" href="/stylesheets/indexBoard.css">
<link rel="stylesheet" href="/stylesheets/layout.css">
<link rel="stylesheet" href="/stylesheets/headerLayout/<%= setting.headerLayout %>.css">
<link rel="stylesheet" href="/stylesheets/footerLayout/<%= setting.footerLayout %>.css">
<meta name="robots" content="index,follow">
<meta name="viewport" content="width=device-width">
<meta name="waffleBoardCheck" content="<%= setting.hash %>">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<script src="/javascripts/main.js" defer></script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="/javascripts/OneSignalSDKWorker.js"></script>
<% if (setting.naverSiteVerification) { %>
<%- setting.naverSiteVerification %>
<% } %>
<!-- Favicon Start -->
<% if (setting.faviconImage) { %>
<link rel="apple-touch-icon" sizes="57x57" href="<%= s3Host %>/assets/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="<%= s3Host %>/assets/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="<%= s3Host %>/assets/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="<%= s3Host %>/assets/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="<%= s3Host %>/assets/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="<%= s3Host %>/assets/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="<%= s3Host %>/assets/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="<%= s3Host %>/assets/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="<%= s3Host %>/assets/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="<%= s3Host %>/assets/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="<%= s3Host %>/assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="<%= s3Host %>/assets/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="<%= s3Host %>/assets/favicon-16x16.png">
<link rel="manifest" href="<%= s3Host %>/assets/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="<%= s3Host %>/assets/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/icon" href="<%= s3Host %>/assets/favicon.ico">
<% } %>
<!--OneSignal SDK-->

<!-- Favicon End -->
<!-- Fonts Start -->
<% if (setting.font === 'basic') { %>
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
  }
</style>
<% } else if (setting.font === 'nexon') { %>
<style>
  @font-face {
    font-family: 'NEXON Lv2 Gothic';
    src: url('/fonts/NEXON Lv2 Gothic.woff');
  }

  body {
    font-family: 'NEXON Lv2 Gothic', Arial, Helvetica, sans-serif;
  }
</style>
<% } else if (setting.font === 'gmarket') { %>
  <style>
    @font-face {
      font-family: 'Gmarket Sans';
      src: url('/fonts/GmarketSansMedium.otf');
    }
  
    body {
      font-family: 'Gmarket Sans', Arial, Helvetica, sans-serif;
    }
  </style>
<% } else if (setting.font === 'SpoqaHanSansNeo') { %>
    <style>
      @font-face {
        font-family: 'SpoqaHanSansNeo';
        src: url('public\fonts\SpoqaHanSansNeo-Regular.otf');
      }
    
      body {
        font-family: 'SpoqaHanSansNeo', Arial, Helvetica, sans-serif;
      }
    </style>
<% } %>

<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async></script>
<script>
  //Another way to initialize OneSignal

  window.OneSignal = window.OneSignal || [];

  var initConfig = {
    appId: "9f162dba-c3de-4265-b55b-0bb9d6eba346",
    // Your other init settings
    notifyButton: {
      enable: true
    },
    promptOptions: {
      customlink: {
        enabled: true, /* Required to use the Custom Link */
        style: "button", /* Has value of 'button' or 'link' */
        size: "medium", /* One of 'small', 'medium', or 'large' */
        color: {
          button: '#E12D30', /* Color of the button background if style = "button" */
          text: '#FFFFFF', /* Color of the prompt's text */
        },
        text: {
          subscribe: "푸쉬 알림 ON", /* Prompt's text when not subscribed */
          unsubscribe: "푸쉬 알림 OFF", /* Prompt's text when subscribed */
          explanation: "푸쉬 알림 설정을 해주세요", /* Optional text appearing before the prompt button */
        },
        unsubscribeEnabled: true, /* Controls whether the prompt is visible after subscription */
      }
    }
  };

  OneSignal.push(function () {
    OneSignal.SERVICE_WORKER_PARAM = { scope: '/public/' };
    OneSignal.SERVICE_WORKER_PATH = 'public/OneSignalSDKWorker.js'
    OneSignal.SERVICE_WORKER_UPDATER_PATH = 'public/OneSignalSDKWorker.js'
    OneSignal.init(initConfig);
  });

  OneSignal.push(function () {
    OneSignal.isPushNotificationsEnabled().then(function (isEnabled) {
      if (isEnabled){
        OneSignal.getUserId().then(function (userId) {
          window.localStorage.setItem('onesignalId', userId);
          console.log("OneSignal User ID:", userId);
          if(isMobile()){
            window.localStorage.setItem("mobileId", userId);
            console.log(JSON.stringify(userId));
            const a = window.localStorage.getItem("mobileId");
            console.log(JSON.stringify(a));
          }
          else{
            window.localStorage.setItem("webId", userId);
            console.log(JSON.stringify(userId));
            const a = window.localStorage.getItem("webId");
            console.log("webId : " + JSON.stringify(a));
          }
        });
      }
    });
    console.log("is it enable" + JSON.stringify(OneSignal.isPushNotificationsEnabled()));
  })

  function isMobile(){
    var user = navigator.userAgent;
    var is_mobile = false;

    if(user.indexOf("iPhone") > -1 || user.indexOf("Android") > -1){
      is_mobile = true;
    }

    return is_mobile;
  }
</script>